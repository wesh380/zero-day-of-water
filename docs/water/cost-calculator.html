<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ماشین‌حساب پیشرفته قیمت تمام‌شده آب در مشهد</title>
  <link rel="stylesheet" href="/assets/css/tailwind.css">
  <link rel="stylesheet" href="../assets/fonts.css">
  <link rel="stylesheet" href="/assets/css/base.css">
  <link rel="stylesheet" href="/assets/css/responsive-baseline.css">
  <link rel="stylesheet" href="../assets/water-cost.css">
  <link rel="stylesheet" href="/assets/global-footer.css">
  <link rel="stylesheet" href="/assets/unified-badge.css">
  <link rel="stylesheet" href="../assets/inline-migration.css" />
  <script defer src="/assets/unified-badge.js"></script>
  <script defer src="/assets/global-footer.js"></script>
  <script src="/assets/js/nav-utils.js" defer></script>
  <link rel="stylesheet" href="/assets/css/header.css">
</head>
<body>
  <a class="skip-link" href="#main">پرش به محتوای اصلی</a>
<main id="main" role="main" class="container mx-auto max-w-6xl px-4 sm:px-6 lg:px-8">
  <h1 class="page-title">ماشین‌حساب پیشرفته قیمت تمام‌شده آب در مشهد</h1>
  <div class="page-sub">شِمای تمیز و کادربندی‌شده؛ ورودی‌ها در راست، خروجی‌ها در چپ</div>

  <section class="grid grid-cols-1 gap-6 lg:[grid-template-columns:1.35fr_.95fr]">
    <!-- ستون چپ: خروجی‌های مدل -->
    <div class="left space-y-6">
      <div class="stat-wrap grid grid-cols-1 gap-4 sm:grid-cols-2">
        <div class="stat badge-warn">
          <div class="label">قیمت پیشنهادی واقعی (به ازای هر مترمکعب)</div>
          <div id="true-price" class="value">—</div>
          <span class="badge" id="true-price-unit">تومان</span>
        </div>
        <div class="stat badge-success">
          <div class="label">قیمت نهایی برای مصرف‌کننده (پس از یارانه/تخفیف)</div>
          <div id="final-price" class="value">—</div>
          <span class="badge" id="final-price-unit">تومان</span>
        </div>
      </div>

      <div class="card dash-card space-y-4">
        <h3>جدول سهم هر متغیر</h3>
        <div class="scroll-x">
          <table class="tbl" aria-describedby="tbl-hint">
            <thead>
              <tr><th>آیتم</th><th>سهم</th><th>پیشرفت</th><th>هزینه</th></tr>
            </thead>
            <tbody id="breakdown-body"><!-- filled by JS --></tbody>
          </table>
        </div>
        <div id="tbl-hint" class="hint mt-8">مقادیر با تغییر ورودی‌ها به‌روزرسانی می‌شوند.</div>
      </div>

      <div class="card dash-card space-y-4">
        <h3>نمودار دونات سهم عوامل</h3>
        <div class="scroll-x">
          <div class="chart-wrap"><canvas id="shareChart"></canvas></div>
        </div>
      </div>

      <div class="card dash-card space-y-4">
        <h3>تحلیل حساسیت (±۱۰٪ در ورودی‌ها)</h3>
        <ul id="sensitivity-list" class="list"><!-- li items by JS --></ul>
      </div>

      <div class="card dash-card note space-y-3">
        <h3>جمع‌بندی تحلیل</h3>
        <div id="analysis-summary">—</div>
      </div>
    </div>

    <!-- ستون راست: ورودی‌های مدل -->
    <div class="right controls space-y-6">
      <div class="card dash-card space-y-5">
        <h3>۱) عوامل فنی و زیربنایی</h3>
        <div class="group space-y-2.5">
          <label for="cost_production">هزینه تولید هر مترمکعب (تومان)</label>
          <div class="inline flex items-center gap-2.5">
            <input id="cost_production" type="number" min="0" step="100" value="2000" aria-describedby="cost_production_r">
          </div>
          <input id="cost_production_r" type="range" min="0" max="10000" step="100" value="2000">
        </div>
        <div class="group space-y-2.5">
          <label for="cost_energy">هزینه انرژی (تومان)</label>
          <input id="cost_energy" type="number" min="0" step="50" value="2000">
          <input id="cost_energy_r" type="range" min="0" max="10000" step="50" value="2000">
        </div>
        <div class="group space-y-2.5">
          <label for="loss_network">درصد هدررفت شبکه (%)</label>
          <input id="loss_network" type="number" min="0" max="100" step="1" value="20">
          <input id="loss_network_r" type="range" min="0" max="100" step="1" value="20">
        </div>
      </div>

      <div class="card dash-card space-y-5">
        <h3>۲) عوامل اقتصادی و مدیریتی</h3>
        <div class="group space-y-2.5">
          <label for="maintenance">هزینه نگهداری و تعمیرات (تومان)</label>
          <input id="maintenance" type="number" min="0" step="50" value="1500">
          <input id="maintenance_r" type="range" min="0" max="10000" step="50" value="1500">
        </div>
        <div class="group space-y-2.5">
          <label for="hidden_subsidy">درصد یارانه پنهان (%)</label>
          <input id="hidden_subsidy" type="number" min="0" max="100" step="1" value="25">
          <input id="hidden_subsidy_r" type="range" min="0" max="100" step="1" value="25">
        </div>
      </div>

      <div class="card dash-card space-y-5">
        <h3>۳) محیطی و اجتماعی</h3>
        <div class="group space-y-2.5">
          <label for="power_change">درصد تغییر قیمتی برق (%)</label>
          <input id="power_change" type="number" min="-100" max="100" step="1" value="0">
          <input id="power_change_r" type="range" min="-100" max="100" step="1" value="0">
        </div>
      </div>

      <div class="card dash-card space-y-5">
        <h3>آزمون ورودی‌ها</h3>
        <div class="group space-y-2.5">
          <label for="chargeinput">شارژ</label>
          <input id="chargeinput" type="text" />
        </div>
        <div class="group space-y-2.5">
          <label for="voteinput">رأی</label>
          <input id="voteinput" type="text" />
        </div>
      </div>

      <div class="actions flex justify-center gap-2.5 mt-3">
        <button id="recalc" class="btn btn-primary inline-flex items-center justify-center gap-2 px-4 py-3 text-base font-extrabold" type="button">به‌روزرسانی محاسبات</button>
      </div>
    </div>
  </section>

  <!-- فوتر فعلی سایت شما بدون تغییر بماند -->
  <div class="footer-note">با هر تغییر در ورودی‌ها، نتایج به‌صورت زنده محاسبه می‌شوند.</div>
</main>

  <script src="../assets/vendor/chart.umd.min.js"></script>
  <script defer src="../assets/water-cost.js"></script>
  <script defer src="../assets/water-init.js"></script>
  <script src="/assets/js/header.js" defer></script>
</body>
</html>
